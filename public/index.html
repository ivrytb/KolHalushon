<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Y24 Cloud Downloader</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; text-align: center; padding-top: 50px; }
        .box { background: #262626; padding: 30px; border-radius: 12px; display: inline-block; width: 350px; }
        input { width: 100%; padding: 10px; margin-bottom: 20px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #27ae60; color: white; border: none; cursor: pointer; border-radius: 6px; }
        #status { margin-top: 20px; color: #f1c40f; }
    </style>
</head>
<body>
    <div class="box">
        <h2>הורדה דרך ענן</h2>
        <input type="text" id="link" placeholder="הדבק לינק כאן">
        <button id="btn" onclick="start()">הורד עכשיו</button>
        <div id="status"></div>
    </div>

    <script>
        async function start() {
            const link = document.getElementById('link').value;
            const status = document.getElementById('status');
            if(!link) return;

            status.innerText = "הורדה החלה... נא להמתין";
            try {
                const response = await fetch('/api/download', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url: link })
                });

                if (!response.ok) throw new Error(await response.text());

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = "music.mp3";
                a.click();
                status.innerText = "הושלם!";
            } catch (e) {
                status.innerText = "שגיאה: " + e.message;
            }
        }
    </script>
</body>
</html>
