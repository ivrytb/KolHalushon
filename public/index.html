<script>
    async function startDownload() {
        // ... (ההתחלה נשארת דומה) ...
        try {
            console.log("LOG: Starting process...");
            // שלב העלאת החלקים
            for (let i = 0; i < totalParts; i++) {
                // ... (קוד העלאה) ...
                const res = await fetch('https://www.call2all.co.il/ym/api/UploadFile', { method: 'POST', body: formData });
                const resData = await res.json();
                console.log(`LOG: Chunk ${i} uploaded. Response:`, resData);
            }

            // שלב הסיום - כאן הוספתי לוג מפורט
            console.log("LOG: Sending DONE request...");
            const finalRes = await fetch(`https://www.call2all.co.il/ym/api/UploadFile?done&token=${config.token}&path=ivr2:KolMevaser/${fileName}&qquuid=${uuid}&qqtotalfilesize=${size}&qqtotalparts=${totalParts}&convertAudio=1`);
            const finalData = await finalRes.json();
            
            console.log("LOG: Final response from Yemot:", finalData);

            if (finalData.status === 'success' || finalData.success === true) {
                // הצלחה
            } else {
                console.error("LOG: Yemot rejected the union. Message:", finalData.message);
                throw new Error(finalData.message || 'איחוד הקובץ נכשל');
            }
        } catch (e) {
            console.error("LOG: Error caught:", e);
            s.innerText = 'שגיאה: ' + e.message;
        }
    }
</script>
